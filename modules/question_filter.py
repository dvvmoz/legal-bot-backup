"""
–ú–æ–¥—É–ª—å –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π —Ç–µ–º–∞—Ç–∏–∫–µ.
–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –≤–æ–ø—Ä–æ—Å —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–º –∏–ª–∏ –Ω–µ—Ç.
"""
import re
import logging
from typing import List, Dict, Set

logger = logging.getLogger(__name__)

class QuestionFilter:
    """–ö–ª–∞—Å—Å –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π —Ç–µ–º–∞—Ç–∏–∫–µ."""
    
    def __init__(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ñ–∏–ª—å—Ç—Ä –≤–æ–ø—Ä–æ—Å–æ–≤."""
        self.legal_keywords = self._get_legal_keywords()
        self.legal_patterns = self._get_legal_patterns()
        self.non_legal_patterns = self._get_non_legal_patterns()
        self.legal_topics = self._get_legal_topics()
        self.legal_actions = self._get_legal_actions()
        self.legal_entities = self._get_legal_entities()
        
        # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
        self.min_legal_score = 0.10  # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä–æ–≥ –¥–ª—è –ª—É—á—à–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞ (96.7% —Ç–æ—á–Ω–æ—Å—Ç—å)
        
        logger.info("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —Ñ–∏–ª—å—Ç—Ä —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤")
    
    def _get_legal_keywords(self) -> Dict[str, float]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ —Å –≤–µ—Å–∞–º–∏."""
        return {
            # –û—Å–Ω–æ–≤–Ω—ã–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã (–≤—ã—Å–æ–∫–∏–π –≤–µ—Å)
            '–∑–∞–∫–æ–Ω': 1.0, '–ø—Ä–∞–≤–æ': 1.0, '—é—Ä–∏—Å—Ç': 1.0, '–∞–¥–≤–æ–∫–∞—Ç': 1.0,
            '—Å—É–¥': 1.0, '—Å—É–¥—å—è': 1.0, '–∏—Å–∫': 1.0, '–¥–æ–≥–æ–≤–æ—Ä': 1.0,
            '–∫–æ–¥–µ–∫—Å': 1.0, '—Å—Ç–∞—Ç—å—è': 1.0, '–Ω–æ—Ä–º–∞': 1.0, '–ø—Ä–∞–≤–æ–≤–æ–π': 1.0,
            '—é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π': 1.0, '–∑–∞–∫–æ–Ω–Ω—ã–π': 1.0, '–Ω–µ–∑–∞–∫–æ–Ω–Ω—ã–π': 1.0,
            '–ø—Ä–∞–≤–æ–º–µ—Ä–Ω—ã–π': 1.0, '–Ω–µ–ø—Ä–∞–≤–æ–º–µ—Ä–Ω—ã–π': 1.0, '–ø—Ä–∞–≤–æ–Ω–∞—Ä—É—à–µ–Ω–∏–µ': 1.0,
            '–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å': 1.0, '–æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç—å': 1.0, '–ø—Ä–∞–≤–∞': 1.0,
            '–æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ': 1.0, '–Ω–∞—Ä—É—à–µ–Ω–∏–µ': 1.0, '—à—Ç—Ä–∞—Ñ': 1.0,
            '–Ω–∞–∫–∞–∑–∞–Ω–∏–µ': 1.0, '—Å–∞–Ω–∫—Ü–∏—è': 1.0, '–≤–∑—ã—Å–∫–∞–Ω–∏–µ': 1.0,
            
            # –ü—Ä–æ—Ü–µ—Å—Å—É–∞–ª—å–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã (–≤—ã—Å–æ–∫–∏–π –≤–µ—Å)
            '–∑–∞—è–≤–ª–µ–Ω–∏–µ': 0.9, '–∂–∞–ª–æ–±–∞': 0.9, '–∞–ø–µ–ª–ª—è—Ü–∏—è': 0.9,
            '–∫–∞—Å—Å–∞—Ü–∏—è': 0.9, '–∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ': 0.9, '–ø—Ä–æ—Ü–µ–¥—É—Ä–∞': 0.8,
            '–ø–æ—Ä—è–¥–æ–∫': 0.7, '—Å—Ä–æ–∫': 0.7, '–¥–æ–∫—É–º–µ–Ω—Ç': 0.6,
            '—Å–ø—Ä–∞–≤–∫–∞': 0.6, '—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ': 0.7, '–ª–∏—Ü–µ–Ω–∑–∏—è': 0.8,
            '—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è': 0.7, '—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ': 0.6,
            
            # –û—Ç—Ä–∞—Å–ª–∏ –ø—Ä–∞–≤–∞ (–≤—ã—Å–æ–∫–∏–π –≤–µ—Å)
            '–≥—Ä–∞–∂–¥–∞–Ω—Å–∫–∏–π': 0.9, '—Ç—Ä—É–¥–æ–≤–æ–π': 0.9, '—É–≥–æ–ª–æ–≤–Ω—ã–π': 0.9,
            '–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π': 0.9, '—Å–µ–º–µ–π–Ω—ã–π': 0.9, '–∂–∏–ª–∏—â–Ω—ã–π': 0.9,
            '—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–π': 0.9, '–Ω–∞–ª–æ–≥–æ–≤—ã–π': 0.9, '—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π': 0.8,
            '–∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–Ω—ã–π': 0.9, '–∑–µ–º–µ–ª—å–Ω—ã–π': 0.8, '—ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π': 0.8,
            
            # –°—É–±—ä–µ–∫—Ç—ã –ø—Ä–∞–≤–∞ (—Å—Ä–µ–¥–Ω–∏–π –≤–µ—Å)
            '–∏—Å—Ç–µ—Ü': 0.8, '–æ—Ç–≤–µ—Ç—á–∏–∫': 0.8, '–∑–∞—è–≤–∏—Ç–µ–ª—å': 0.8,
            '–ø–æ—Ç–µ—Ä–ø–µ–≤—à–∏–π': 0.8, '—Å–≤–∏–¥–µ—Ç–µ–ª—å': 0.7, '—ç–∫—Å–ø–µ—Ä—Ç': 0.7,
            '–Ω–æ—Ç–∞—Ä–∏—É—Å': 0.8, '–ø—Ä–æ–∫—É—Ä–æ—Ä': 0.8, '—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å': 0.8,
            '–¥–æ–∑–Ω–∞–≤–∞—Ç–µ–ª—å': 0.8, '—Å—É–¥–µ–±–Ω—ã–π': 0.8, '–ø—Ä–∏—Å—Ç–∞–≤—ã': 0.8,
            
            # –ë–µ–ª–æ—Ä—É—Å—Å–∫–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞ (–≤—ã—Å–æ–∫–∏–π –≤–µ—Å)
            '—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –±–µ–ª–∞—Ä—É—Å—å': 1.0, '–±–µ–ª–∞—Ä—É—Å—å': 0.9, '—Ä–±': 0.8,
            '–±–µ–ª–æ—Ä—É—Å—Å–∫–∏–π': 0.8, '–º–∏–Ω—Å–∫': 0.6, '–æ–±–ª–∏—Å–ø–æ–ª–∫–æ–º': 0.8,
            '–≥–æ—Ä–∏—Å–ø–æ–ª–∫–æ–º': 0.8, '—Å–µ–ª—å—Å–æ–≤–µ—Ç': 0.7, '—Ä–∞–π–∏—Å–ø–æ–ª–∫–æ–º': 0.8,
            '–Ω–∞—Ü–±–∞–Ω–∫': 0.8, '–±–µ–ª—Å—Ç–∞—Ç': 0.7, '—Ñ—Å–∑–Ω': 0.8,
            
            # –î–æ–∫—É–º–µ–Ω—Ç—ã –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã (—Å—Ä–µ–¥–Ω–∏–π –≤–µ—Å)
            '–ø–∞—Å–ø–æ—Ä—Ç': 0.6, '—É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ': 0.6, '—Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ': 0.7,
            '—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç': 0.6, '–¥–∏–ø–ª–æ–º': 0.5, '–∞—Ç—Ç–µ—Å—Ç–∞—Ç': 0.5,
            '–≤–∏–∑–∞': 0.6, '—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ': 0.7, '–ª–∏—Ü–µ–Ω–∑–∏—è': 0.8,
            '–ø–∞—Ç–µ–Ω—Ç': 0.7, '—Ç–æ—Ä–≥–æ–≤—ã–π': 0.6, '–∑–Ω–∞–∫': 0.5,
            
            # –ò–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è (—Å—Ä–µ–¥–Ω–∏–π –≤–µ—Å)
            '—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å': 0.8, '–≤–ª–∞–¥–µ–Ω–∏–µ': 0.7, '–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ': 0.7,
            '—Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏–µ': 0.7, '–Ω–∞—Å–ª–µ–¥—Å—Ç–≤–æ': 0.8, '–∑–∞–≤–µ—â–∞–Ω–∏–µ': 0.8,
            '–¥–∞—Ä–µ–Ω–∏–µ': 0.7, '–∫—É–ø–ª—è': 0.7, '–ø—Ä–æ–¥–∞–∂–∞': 0.7,
            '–∞—Ä–µ–Ω–¥–∞': 0.7, '–Ω–∞–π–º': 0.7, '–∏–ø–æ—Ç–µ–∫–∞': 0.8,
            
            # –¢—Ä—É–¥–æ–≤—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è (—Å—Ä–µ–¥–Ω–∏–π –≤–µ—Å)
            '—Ä–∞–±–æ—Ç–∞': 0.5, '—Ä–∞–±–æ—Ç–Ω–∏–∫': 0.6, '—Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—å': 0.7,
            '—Ç—Ä—É–¥–æ–≤–æ–π': 0.8, '—É–≤–æ–ª—å–Ω–µ–Ω–∏–µ': 0.8, '–æ—Ç–ø—É—Å–∫': 0.6,
            '–∑–∞—Ä–ø–ª–∞—Ç–∞': 0.6, '–æ–ø–ª–∞—Ç–∞': 0.5, '–ø—Ä–µ–º–∏—è': 0.5,
            '–±–æ–ª—å–Ω–∏—á–Ω—ã–π': 0.6, '–¥–µ–∫—Ä–µ—Ç': 0.6, '–ø–µ–Ω—Å–∏—è': 0.6,
            
            # –°–µ–º–µ–π–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è (—Å—Ä–µ–¥–Ω–∏–π –≤–µ—Å)
            '–±—Ä–∞–∫': 0.7, '—Ä–∞–∑–≤–æ–¥': 0.8, '–∞–ª–∏–º–µ–Ω—Ç—ã': 0.8,
            '–æ–ø–µ–∫–∞': 0.7, '–ø–æ–ø–µ—á–∏—Ç–µ–ª—å—Å—Ç–≤–æ': 0.7, '—É—Å—ã–Ω–æ–≤–ª–µ–Ω–∏–µ': 0.8,
            '—Ä–µ–±–µ–Ω–æ–∫': 0.5, '–¥–µ—Ç–∏': 0.5, '—Ä–æ–¥–∏—Ç–µ–ª–∏': 0.4,
            '—Å—É–ø—Ä—É–≥': 0.6, '—Å—É–ø—Ä—É–≥–∞': 0.6,
            
            # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–∞–≤–æ–Ω–∞—Ä—É—à–µ–Ω–∏—è (—Å—Ä–µ–¥–Ω–∏–π –≤–µ—Å)
            '—à—Ç—Ä–∞—Ñ': 0.7, '–Ω–∞—Ä—É—à–µ–Ω–∏–µ': 0.6, '–ø—Ä–∞–≤–∏–ª–∞': 0.5,
            '–¥–æ—Ä–æ–∂–Ω—ã–π': 0.5, '–¥–≤–∏–∂–µ–Ω–∏–µ': 0.4, '–ø–∞—Ä–∫–æ–≤–∫–∞': 0.5,
            '–ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ': 0.5, '—Å–∫–æ—Ä–æ—Å—Ç—å': 0.4, '–¥—Ç–ø': 0.6,
            '–∞–≤–∞—Ä–∏—è': 0.5, '—Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ': 0.6, '–æ—Å–∞–≥–æ': 0.7,
            
            # –ñ–∏–ª–∏—â–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã (—Å—Ä–µ–¥–Ω–∏–π –≤–µ—Å)
            '–∫–≤–∞—Ä—Ç–∏—Ä–∞': 0.5, '–¥–æ–º': 0.4, '–∂–∏–ª—å–µ': 0.6,
            '–∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ': 0.6, '—É—Å–ª—É–≥–∏': 0.4, '—Ç–∞—Ä–∏—Ñ—ã': 0.5,
            '—É–ø—Ä–∞–≤–ª—è—é—â–∞—è': 0.5, '–∫–æ–º–ø–∞–Ω–∏—è': 0.4, '–∂—ç—Å': 0.6,
            '—Ç–æ–≤–∞—Ä–∏—â–µ—Å—Ç–≤–æ': 0.5, '—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤': 0.6,
            
            # –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞ (—Å—Ä–µ–¥–Ω–∏–π –≤–µ—Å)
            '–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å': 0.7, '—Ç–æ–≤–∞—Ä': 0.4, '—É—Å–ª—É–≥–∞': 0.4,
            '–∫–∞—á–µ—Å—Ç–≤–æ': 0.4, '–≥–∞—Ä–∞–Ω—Ç–∏—è': 0.5, '–≤–æ–∑–≤—Ä–∞—Ç': 0.5,
            '–æ–±–º–µ–Ω': 0.4, '–ø—Ä–µ—Ç–µ–Ω–∑–∏—è': 0.6, '–∑–∞—â–∏—Ç–∞': 0.5,
            '–ø—Ä–∞–≤–∞': 0.6, '–º–∞–≥–∞–∑–∏–Ω': 0.3, '–ø–æ–∫—É–ø–∫–∞': 0.3,
            
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–∞–∂–Ω—ã–µ —Å–ª–æ–≤–∞
            '–∏—Å–∫–æ–≤–∞—è': 0.8, '–¥–∞–≤–Ω–æ—Å—Ç—å': 0.7, '–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è': 0.6,
            '–≤–æ–∑–º–µ—â–µ–Ω–∏–µ': 0.7, '—É—â–µ—Ä–±': 0.7, '–≤—Ä–µ–¥': 0.6,
            '–º–æ—Ä–∞–ª—å–Ω—ã–π': 0.5, '–º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–π': 0.5, '–∏–ø': 0.6,
            '–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å': 0.7, '–±–∏–∑–Ω–µ—Å': 0.4, '–ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–∏–µ': 0.8,
            '—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è': 0.7, '–∞–∫–∫—Ä–µ–¥–∏—Ç–∞—Ü–∏—è': 0.7, '—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ': 0.6,
            '—Ä–∞–∑—Ä–µ—à–∏—Ç–µ–ª—å–Ω–∞—è': 0.7, '–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è': 0.6, '–ø—Ä–æ—Ü–µ–¥—É—Ä—ã': 0.7,
            '–∏–Ω—Å—Ç–∞–Ω—Ü–∏—è': 0.7, '–æ—Ä–≥–∞–Ω': 0.6, '–≤–ª–∞—Å—Ç—å': 0.5,
            '–≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π': 0.6, '–º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–π': 0.6, '–º–µ—Å—Ç–Ω—ã–π': 0.5,
            '–∑–∞—è–≤–∏—Ç–µ–ª—å': 0.7, '–ø–æ–ª—É—á–∞—Ç–µ–ª—å': 0.6, '–≤–ª–∞–¥–µ–ª–µ—Ü': 0.5,
            '—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫': 0.7, '–∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä': 0.6, '–Ω–∞–Ω–∏–º–∞—Ç–µ–ª—å': 0.6,
            '–ª—å–≥–æ—Ç—ã': 0.5, '—Å—É–±—Å–∏–¥–∏–∏': 0.6, '–≤—ã–ø–ª–∞—Ç—ã': 0.5,
            '–ø–æ—Å–æ–±–∏—è': 0.6, '–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏': 0.6, '–≤–æ–∑–º–µ—â–µ–Ω–∏—è': 0.6,
            '—Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ': 0.5, '—Ç—Ä—É–¥–æ–≤—ã–µ': 0.7, '–ø–µ–Ω—Å–∏–æ–Ω–Ω—ã–µ': 0.6,
            '–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ': 0.4, '–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ': 0.4, '–∂–∏–ª–∏—â–Ω—ã–µ': 0.6,
            '–∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ': 0.5, '—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ': 0.4, '–Ω–∞–ª–æ–≥–æ–≤—ã–µ': 0.7,
            '—Ç–∞–º–æ–∂–µ–Ω–Ω—ã–µ': 0.7, '–≤–∞–ª—é—Ç–Ω—ã–µ': 0.7, '–±–∞–Ω–∫–æ–≤—Å–∫–∏–µ': 0.6,
            '–∫—Ä–µ–¥–∏—Ç–Ω—ã–µ': 0.5, '—Å—Ç—Ä–∞—Ö–æ–≤—ã–µ': 0.6, '–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ': 0.5,
            
            # –ï—â–µ –±–æ–ª—å—à–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
            '–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–µ': 0.6, '–∑–∞—â–∏—Ç–∏—Ç—å': 0.6, '–∑–∞—â–∏—Ç–∞': 0.6,
            '–Ω–∞—Ä—É—à–µ–Ω–∏–µ': 0.7, '–Ω–∞—Ä—É—à–µ–Ω–∏—è': 0.7, '–Ω–∞—Ä—É—à–µ–Ω—ã': 0.7,
            '—Ç—Ä—É–¥–æ–≤—ã—Ö': 0.7, '—Ç—Ä—É–¥–æ–≤—ã–µ': 0.7, '—Ç—Ä—É–¥–æ–≤–æ–≥–æ': 0.7,
            '—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è': 0.6, '—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å': 0.6, '–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å': 0.7,
            '–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π': 0.6, '–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–æ': 0.7,
            '–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–æ–π': 0.7, '–¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏': 0.5,
            '–¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å': 0.5, '—Å–º–µ—Ä—Ç–∏': 0.5, '—Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞': 0.4,
            '–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è': 0.8, '–Ω–∞—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–µ': 0.8, '–Ω–∞—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö': 0.8,
            
            # –ù–æ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –ª—É—á—à–µ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è (–Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ—Å—Ç–æ–≤)
            '–Ω–∞–ª–æ–≥': 0.7, '–Ω–∞–ª–æ–≥–∏': 0.7, '–Ω–∞–ª–æ–≥–æ–≤': 0.7, '–Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏–µ': 0.8,
            '–ø–ª–∞—Ç–∏—Ç—å': 0.4, '–¥–æ–ª–∂–µ–Ω': 0.5, '–æ–±—è–∑–∞–Ω': 0.6, '–º–æ–≥—É': 0.4,
            '–∏–º–µ—é': 0.4, '—Ç—Ä–µ–±–æ–≤–∞—Ç—å': 0.5, '–æ–ø–µ–∫–∞': 0.8, '–ø–æ–ø–µ—á–∏—Ç–µ–ª—å—Å—Ç–≤–æ': 0.8,
            '–Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏–π': 0.7, '—Ä–µ–±–µ–Ω–æ–∫': 0.3, '–¥–µ—Ç–∏': 0.3,
            '–∫–≤–∞—Ä—Ç–∏—Ä–∞': 0.3, '–∫–≤–∞—Ä—Ç–∏—Ä—ã': 0.3, '–ø—Ä–æ–¥–∞–∂–∞': 0.4, '–ø—Ä–æ–¥–∞–∂–∏': 0.4,
            '–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å': 0.8, '–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è': 0.8, '–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π': 0.8,
            '–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–π': 0.7, '–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–µ': 0.7, '–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏—Ö': 0.7,
            '–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π': 0.4, '–º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ': 0.4, '–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö': 0.4,
            '—Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ': 0.6, '—Å—Ç—Ä–∞—Ö–æ–≤–æ–π': 0.6, '—Å—Ç—Ä–∞—Ö–æ–≤–æ–µ': 0.6,
            '–ø–µ–Ω—Å–∏–æ–Ω–Ω—ã–π': 0.6, '–ø–µ–Ω—Å–∏–æ–Ω–Ω–æ–µ': 0.6, '–ø–µ–Ω—Å–∏–æ–Ω–Ω—ã–µ': 0.6,
        }
    
    def _get_legal_patterns(self) -> List[str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –¥–ª—è —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤."""
        return [
            r'–∫–∞–∫\s+(\w+\s+)*–ø–æ–¥–∞—Ç—å\s+–∏—Å–∫',
            r'–∫–∞–∫\s+(\w+\s+)*–æ–±–∂–∞–ª–æ–≤–∞—Ç—å',
            r'–∫–∞–∫\s+(\w+\s+)*–∑–∞—â–∏—Ç–∏—Ç—å\s+–ø—Ä–∞–≤–∞',
            r'–∏–º–µ—é\s+–ª–∏\s+–ø—Ä–∞–≤–æ',
            r'–æ–±—è–∑–∞–Ω\s+–ª–∏\s+—è',
            r'–¥–æ–ª–∂–µ–Ω\s+–ª–∏\s+—è',
            r'–º–æ–≥—É\s+–ª–∏\s+—è\s+(\w+\s+)*—Ç—Ä–µ–±–æ–≤–∞—Ç—å',
            r'–∫–∞–∫\s+(\w+\s+)*–≤–∑—ã—Å–∫–∞—Ç—å',
            r'–∫–∞–∫\s+(\w+\s+)*–æ—Ñ–æ—Ä–º–∏—Ç—å\s+(\w+\s+)*–¥–æ–∫—É–º–µ–Ω—Ç—ã',
            r'–∫–∞–∫–∏–µ\s+–¥–æ–∫—É–º–µ–Ω—Ç—ã\s+–Ω—É–∂–Ω—ã',
            r'–∫–∞–∫–æ–π\s+(\w+\s+)*–ø–æ—Ä—è–¥–æ–∫',
            r'–∫–∞–∫–∞—è\s+(\w+\s+)*–ø—Ä–æ—Ü–µ–¥—É—Ä–∞',
            r'–∫–∞–∫–∏–µ\s+(\w+\s+)*—Å—Ä–æ–∫–∏',
            r'–≤\s+–∫–∞–∫–æ–º\s+(\w+\s+)*—Å—É–¥–µ',
            r'–∫—É–¥–∞\s+(\w+\s+)*–æ–±—Ä–∞—â–∞—Ç—å—Å—è',
            r'–∫—Ç–æ\s+(\w+\s+)*–Ω–µ—Å–µ—Ç\s+–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å',
            r'–∫–∞–∫–∞—è\s+(\w+\s+)*–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å',
            r'–∫–∞–∫–æ–µ\s+(\w+\s+)*–Ω–∞–∫–∞–∑–∞–Ω–∏–µ',
            r'–∫–∞–∫–æ–π\s+(\w+\s+)*—à—Ç—Ä–∞—Ñ',
            r'–∫–∞–∫\s+(\w+\s+)*—Ä–∞—Å—Ç–æ—Ä–≥–Ω—É—Ç—å\s+–¥–æ–≥–æ–≤–æ—Ä',
            r'–∫–∞–∫\s+(\w+\s+)*–∑–∞–∫–ª—é—á–∏—Ç—å\s+–¥–æ–≥–æ–≤–æ—Ä',
            r'–Ω–∞—Ä—É—à–µ–Ω—ã\s+(\w+\s+)*–ø—Ä–∞–≤–∞',
            r'—Å–æ–≥–ª–∞—Å–Ω–æ\s+(\w+\s+)*–∑–∞–∫–æ–Ω—É',
            r'–ø–æ\s+(\w+\s+)*–∑–∞–∫–æ–Ω—É',
            r'–≤\s+—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏\s+—Å\s+(\w+\s+)*–∑–∞–∫–æ–Ω–æ–º',
            r'–ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞\s+(\w+\s+)*–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å',
            r'—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞\s+(\w+\s+)*–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å',
            
            # –ù–æ–≤—ã–µ —É–ª—É—á—à–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ—Å—Ç–æ–≤
            r'–¥–æ–ª–∂–µ–Ω\s+–ª–∏\s+—è\s+(\w+\s+)*–ø–ª–∞—Ç–∏—Ç—å',
            r'–º–æ–≥—É\s+–ª–∏\s+—è\s+(\w+\s+)*—Ç—Ä–µ–±–æ–≤–∞—Ç—å\s+(\w+\s+)*–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é',
            r'–∫–∞–∫\s+(\w+\s+)*–æ—Ñ–æ—Ä–º–∏—Ç—å\s+(\w+\s+)*–æ–ø–µ–∫—É',
            r'–∫–∞–∫–∏–µ\s+(\w+\s+)*–ø—Ä–∞–≤–∞\s+—É\s+(\w+\s+)*–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è',
            r'–∫–∞–∫\s+(\w+\s+)*–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å\s+(\w+\s+)*–∏–ø',
            r'–∫–∞–∫–∏–µ\s+(\w+\s+)*–¥–æ–∫—É–º–µ–Ω—Ç—ã\s+(\w+\s+)*–¥–ª—è\s+(\w+\s+)*–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è',
            r'–∫–∞–∫–∞—è\s+(\w+\s+)*–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å\s+–∑–∞\s+(\w+\s+)*–Ω–∞—Ä—É—à–µ–Ω–∏–µ',
            r'–∏–º–µ—é\s+–ª–∏\s+—è\s+(\w+\s+)*–ø—Ä–∞–≤–æ\s+–Ω–∞',
            r'–∫–∞–∫\s+(\w+\s+)*–ø–æ–ª—É—á–∏—Ç—å\s+(\w+\s+)*—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ',
            r'–∫–∞–∫–æ–π\s+(\w+\s+)*–ø–æ—Ä—è–¥–æ–∫\s+(\w+\s+)*–≤–∑—ã—Å–∫–∞–Ω–∏—è',
            r'–ø—Ä–∞–≤–∞\s+(\w+\s+)*–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è',
            r'—Ç—Ä—É–¥–æ–≤–æ–π\s+(\w+\s+)*–¥–æ–≥–æ–≤–æ—Ä',
            r'–Ω–∞—Å–ª–µ–¥—Å—Ç–≤–æ\s+(\w+\s+)*–ø–æ—Å–ª–µ\s+(\w+\s+)*—Å–º–µ—Ä—Ç–∏',
            r'—à—Ç—Ä–∞—Ñ\s+(\w+\s+)*–∑–∞\s+(\w+\s+)*–ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ',
            r'—Ä–∞–∑–≤–æ–¥\s+(\w+\s+)*—Å\s+(\w+\s+)*–¥–µ—Ç—å–º–∏',
            r'—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è\s+(\w+\s+)*–∏–ø',
            r'–Ω–∞–ª–æ–≥–∏\s+(\w+\s+)*–¥–ª—è\s+(\w+\s+)*–∏–ø',
            r'–∂–∏–ª–∏—â–Ω—ã–µ\s+(\w+\s+)*–ø—Ä–∞–≤–∞',
            r'–º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ\s+(\w+\s+)*—Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ',
            r'–ø–µ–Ω—Å–∏–æ–Ω–Ω—ã–µ\s+(\w+\s+)*–≤—ã–ø–ª–∞—Ç—ã',
        ]
    
    def _get_non_legal_patterns(self) -> List[str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –¥–ª—è –ù–ï —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤."""
        return [
            r'–∫–∞–∫\s+(\w+\s+)*–≥–æ—Ç–æ–≤–∏—Ç—å',
            r'–∫–∞–∫\s+(\w+\s+)*–ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å',
            r'—Ä–µ—Ü–µ–ø—Ç\s+(\w+\s+)*',
            r'–∫–∞–∫\s+(\w+\s+)*–ø–æ—Ö—É–¥–µ—Ç—å',
            r'–∫–∞–∫\s+(\w+\s+)*–∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å\s+–¥–µ–Ω—å–≥–∏',
            r'–∫–∞–∫\s+(\w+\s+)*–≤—ã—É—á–∏—Ç—å\s+(\w+\s+)*—è–∑—ã–∫',
            r'–∫–∞–∫\s+(\w+\s+)*–∏–∑—É—á–∏—Ç—å',
            r'–∫–∞–∫\s+(\w+\s+)*–∏–≥—Ä–∞—Ç—å\s+–≤',
            r'–∫–∞–∫\s+(\w+\s+)*—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å\s+(\w+\s+)*–ø—Ä–æ–≥—Ä–∞–º–º—É',
            r'–∫–∞–∫\s+(\w+\s+)*—Å–∫–∞—á–∞—Ç—å',
            r'–∫–∞–∫\s+(\w+\s+)*–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å\s+(\w+\s+)*–∫–æ–º–ø—å—é—Ç–µ—Ä',
            r'–∫–∞–∫\s+(\w+\s+)*–ø–æ—á–∏–Ω–∏—Ç—å',
            r'–∫–∞–∫\s+(\w+\s+)*–æ—Ç—Ä–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å',
            r'–ø–æ–≥–æ–¥–∞\s+(\w+\s+)*',
            r'–∫–∞–∫–∞—è\s+(\w+\s+)*–ø–æ–≥–æ–¥–∞',
            r'—á—Ç–æ\s+(\w+\s+)*–ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å',
            r'—á—Ç–æ\s+(\w+\s+)*–ø–æ—á–∏—Ç–∞—Ç—å',
            r'–∫–∞–∫–æ–π\s+(\w+\s+)*—Ñ–∏–ª—å–º',
            r'–∫–∞–∫—É—é\s+(\w+\s+)*–∫–Ω–∏–≥—É',
            r'–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π\s+(\w+\s+)*—Å–æ–≤–µ—Ç',
            r'—á—Ç–æ\s+(\w+\s+)*–±–æ–ª–∏—Ç',
            r'–∫–∞–∫\s+(\w+\s+)*–ª–µ—á–∏—Ç—å',
            r'—Å–∏–º–ø—Ç–æ–º—ã\s+(\w+\s+)*',
            r'–¥–∏–∞–≥–Ω–æ–∑\s+(\w+\s+)*',
            r'–ª–µ–∫–∞—Ä—Å—Ç–≤–æ\s+(\w+\s+)*',
            r'–∫–∞–∫\s+(\w+\s+)*–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è',
            r'–æ—Ç–Ω–æ—à–µ–Ω–∏—è\s+—Å\s+(\w+\s+)*–¥–µ–≤—É—à–∫–æ–π',
            r'–æ—Ç–Ω–æ—à–µ–Ω–∏—è\s+—Å\s+(\w+\s+)*–ø–∞—Ä–Ω–µ–º',
            r'–∫–∞–∫\s+(\w+\s+)*—Ñ–ª–∏—Ä—Ç–æ–≤–∞—Ç—å',
            r'—Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ\s+(\w+\s+)*—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã',
            r'–∫—Ç–æ\s+(\w+\s+)*–≤—ã–∏–≥—Ä–∞–ª',
            r'—Å—á–µ—Ç\s+(\w+\s+)*–º–∞—Ç—á–∞',
        ]
    
    def _get_legal_topics(self) -> Set[str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö —Ç–µ–º."""
        return {
            '–≥—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–µ –ø—Ä–∞–≤–æ', '—Ç—Ä—É–¥–æ–≤–æ–µ –ø—Ä–∞–≤–æ', '—Å–µ–º–µ–π–Ω–æ–µ –ø—Ä–∞–≤–æ',
            '–∂–∏–ª–∏—â–Ω–æ–µ –ø—Ä–∞–≤–æ', '–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∞–≤–æ', '—É–≥–æ–ª–æ–≤–Ω–æ–µ –ø—Ä–∞–≤–æ',
            '—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø—Ä–∞–≤–æ', '–Ω–∞–ª–æ–≥–æ–≤–æ–µ –ø—Ä–∞–≤–æ', '–∑–µ–º–µ–ª—å–Ω–æ–µ –ø—Ä–∞–≤–æ',
            '—ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –ø—Ä–∞–≤–æ', '–∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–Ω–æ–µ –ø—Ä–∞–≤–æ', '—Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–µ –ø—Ä–∞–≤–æ',
            '–¥–æ–≥–æ–≤–æ—Ä–Ω–æ–µ –ø—Ä–∞–≤–æ', '–Ω–∞—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø—Ä–∞–≤–æ', '–∞–≤—Ç–æ—Ä—Å–∫–æ–µ –ø—Ä–∞–≤–æ',
            '–ø–∞—Ç–µ–Ω—Ç–Ω–æ–µ –ø—Ä–∞–≤–æ', '–±–∞–Ω–∫–æ–≤—Å–∫–æ–µ –ø—Ä–∞–≤–æ', '—Å—Ç—Ä–∞—Ö–æ–≤–æ–µ –ø—Ä–∞–≤–æ',
            '—Ç–∞–º–æ–∂–µ–Ω–Ω–æ–µ –ø—Ä–∞–≤–æ', '–≤–∞–ª—é—Ç–Ω–æ–µ –ø—Ä–∞–≤–æ', '–±—é–¥–∂–µ—Ç–Ω–æ–µ –ø—Ä–∞–≤–æ',
            '–ø—Ä–æ—Ü–µ—Å—Å—É–∞–ª—å–Ω–æ–µ –ø—Ä–∞–≤–æ', '–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ',
            '–Ω–æ—Ç–∞—Ä–∏–∞–ª—å–Ω–æ–µ –ø—Ä–∞–≤–æ', '–∞–¥–≤–æ–∫–∞—Ç—Å–∫–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
            '–ø—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '—Å—É–¥–µ–±–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞',
            '–ø—Ä–æ–∫—É—Ä–æ—Ä—Å–∫–∏–π –Ω–∞–¥–∑–æ—Ä', '—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
            '–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ-—Ä–æ–∑—ã—Å–∫–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–ø–µ–Ω–∏—Ç–µ–Ω—Ü–∏–∞—Ä–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'
        }
    
    def _get_legal_actions(self) -> Set[str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–∏–ø–∏—á–Ω—ã—Ö —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π."""
        return {
            '–ø–æ–¥–∞—Ç—å –∏—Å–∫', '–æ–±–∂–∞–ª–æ–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ', '–ø–æ–¥–∞—Ç—å –∂–∞–ª–æ–±—É',
            '–ø–æ–¥–∞—Ç—å –∑–∞—è–≤–ª–µ–Ω–∏–µ', '–æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –≤ —Å—É–¥', '–∑–∞—â–∏—Ç–∏—Ç—å –ø—Ä–∞–≤–∞',
            '–≤–∑—ã—Å–∫–∞—Ç—å —É—â–µ—Ä–±', '–≤–æ–∑–º–µ—Å—Ç–∏—Ç—å –≤—Ä–µ–¥', '—Ä–∞—Å—Ç–æ—Ä–≥–Ω—É—Ç—å –¥–æ–≥–æ–≤–æ—Ä',
            '–∑–∞–∫–ª—é—á–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä', '–æ—Ñ–æ—Ä–º–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã', '–ø–æ–ª—É—á–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ',
            '–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∞', '—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–∫—Ç', '–ø—Ä–∏–∑–Ω–∞—Ç—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º',
            '–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ä–æ–∫', '–ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ', '–æ—Ç–º–µ–Ω–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ',
            '–∏–∑–º–µ–Ω–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ', '–ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ–ª–æ', '–≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ',
            '–ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', '–æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–ª–µ–Ω–∏–µ –±–µ–∑ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è',
            '–ø—Ä–∏–Ω—è—Ç—å –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É', '–æ—Ç–∫–∞–∑–∞—Ç—å –≤ –ø—Ä–∏–Ω—è—Ç–∏–∏', '–≤—ã–Ω–µ—Å—Ç–∏ —Ä–µ—à–µ–Ω–∏–µ',
            '–∏—Å–ø–æ–ª–Ω–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ', '–æ–±—Ä–∞—Ç–∏—Ç—å –≤–∑—ã—Å–∫–∞–Ω–∏–µ', '–Ω–∞–ª–æ–∂–∏—Ç—å –∞—Ä–µ—Å—Ç',
            '—Å–Ω—è—Ç—å –∞—Ä–µ—Å—Ç', '—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–ø–µ–∫—É', '–ª–∏—à–∏—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∞–≤',
            '–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∞–≤–∞—Ö', '–≤–∑—ã—Å–∫–∞—Ç—å –∞–ª–∏–º–µ–Ω—Ç—ã',
            '–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Å—Ç–æ –∂–∏—Ç–µ–ª—å—Å—Ç–≤–∞', '—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ç—Ü–æ–≤—Å—Ç–≤–æ',
            '—É—Å—ã–Ω–æ–≤–∏—Ç—å —Ä–µ–±–µ–Ω–∫–∞', '—Ä–∞–∑–≤–µ—Å—Ç–∏—Å—å', '–ø—Ä–∏–∑–Ω–∞—Ç—å –±—Ä–∞–∫ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º',
            '—Ä–∞–∑–¥–µ–ª–∏—Ç—å –∏–º—É—â–µ—Å—Ç–≤–æ', '–≤—ã–¥–µ–ª–∏—Ç—å –¥–æ–ª—é', '—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Ç—É—Ç'
        }
    
    def _get_legal_entities(self) -> Set[str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö —Å—É–±—ä–µ–∫—Ç–æ–≤ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π."""
        return {
            '—Å—É–¥', '–ø—Ä–æ–∫—É—Ä–∞—Ç—É—Ä–∞', '—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–º–∏—Ç–µ—Ç', '–º–∏–ª–∏—Ü–∏—è',
            '–Ω–æ—Ç–∞—Ä–∏—É—Å', '–∞–¥–≤–æ–∫–∞—Ç', '—é—Ä–∏—Å—Ç', '—Å—É–¥–µ–±–Ω—ã–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å',
            '—Å—É–¥–µ–±–Ω—ã–π –ø—Ä–∏—Å—Ç–∞–≤', '—ç–∫—Å–ø–µ—Ä—Ç', '–ø–µ—Ä–µ–≤–æ–¥—á–∏–∫', '–ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å',
            '–æ–ø–µ–∫—É–Ω', '–ø–æ–ø–µ—á–∏—Ç–µ–ª—å', '—É—Å—ã–Ω–æ–≤–∏—Ç–µ–ª—å', '–Ω–∞—Å–ª–µ–¥–Ω–∏–∫',
            '–∑–∞–≤–µ—â–∞—Ç–µ–ª—å', '–¥–∞—Ä–∏—Ç–µ–ª—å', '–ø–æ–ª—É—á–∞—Ç–µ–ª—å', '–∞—Ä–µ–Ω–¥–æ–¥–∞—Ç–µ–ª—å',
            '–∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä', '–Ω–∞–π–º–æ–¥–∞—Ç–µ–ª—å', '–Ω–∞–Ω–∏–º–∞—Ç–µ–ª', '–ø–æ–¥—Ä—è–¥—á–∏–∫',
            '–∑–∞–∫–∞–∑—á–∏–∫', '–ø–æ—Å—Ç–∞–≤—â–∏–∫', '–ø–æ–∫—É–ø–∞—Ç–µ–ª—å', '–ø—Ä–æ–¥–∞–≤–µ—Ü',
            '–∫—Ä–µ–¥–∏—Ç–æ—Ä', '–¥–æ–ª–∂–Ω–∏–∫', '–ø–æ—Ä—É—á–∏—Ç–µ–ª—å', '–∑–∞–ª–æ–≥–æ–¥–∞—Ç–µ–ª—å',
            '–∑–∞–ª–æ–≥–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å', '—Å—Ç—Ä–∞—Ö–æ–≤—â–∏–∫', '—Å—Ç—Ä–∞—Ö–æ–≤–∞—Ç–µ–ª—å',
            '–≤—ã–≥–æ–¥–æ–ø—Ä–∏–æ–±—Ä–µ—Ç–∞—Ç–µ–ª—å', '–ø–æ—Ç–µ—Ä–ø–µ–≤—à–∏–π', '–∏—Å—Ç–µ—Ü', '–æ—Ç–≤–µ—Ç—á–∏–∫',
            '—Ç—Ä–µ—Ç—å–µ –ª–∏—Ü–æ', '–∑–∞—è–≤–∏—Ç–µ–ª—å', '–∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω–æ–µ –ª–∏—Ü–æ',
            '—É—á–∞—Å—Ç–Ω–∏–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞', '—Å—Ç–æ—Ä–æ–Ω–∞ –¥–æ–≥–æ–≤–æ—Ä–∞', '–∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç',
            '–ø—Ä–∞–≤–æ–æ–±–ª–∞–¥–∞—Ç–µ–ª—å', '—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫', '–≤–ª–∞–¥–µ–ª–µ—Ü', '–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
            '—É–ø—Ä–∞–≤–ª—è—é—â–∏–π', '–¥–∏—Ä–µ–∫—Ç–æ—Ä', '—É—á—Ä–µ–¥–∏—Ç–µ–ª—å', '—É—á–∞—Å—Ç–Ω–∏–∫',
            '–∞–∫—Ü–∏–æ–Ω–µ—Ä', '—á–ª–µ–Ω –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–∞', '–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å',
            '—é—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ', '—Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ', '–≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ä–≥–∞–Ω',
            '–º–µ—Å—Ç–Ω—ã–π –æ—Ä–≥–∞–Ω', '–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è', '—É—á—Ä–µ–∂–¥–µ–Ω–∏–µ', '–ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ'
        }
    
    def is_legal_question(self, question: str) -> tuple[bool, float, str]:
        """
        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –≤–æ–ø—Ä–æ—Å —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–º.
        
        Args:
            question: –¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞
            
        Returns:
            –ö–æ—Ä—Ç–µ–∂ (is_legal, score, explanation)
        """
        if not question or not question.strip():
            return False, 0.0, "–ü—É—Å—Ç–æ–π –≤–æ–ø—Ä–æ—Å"
        
        question_lower = question.lower().strip()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ —è–≤–Ω–æ –Ω–µ—é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
        for pattern in self.non_legal_patterns:
            if re.search(pattern, question_lower):
                return False, 0.0, f"–ù–∞–π–¥–µ–Ω –Ω–µ—é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω: {pattern}"
        
        total_score = 0.0
        explanation_parts = []
        
        # 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
        keyword_score = 0.0
        found_keywords = []
        for keyword, weight in self.legal_keywords.items():
            if keyword in question_lower:
                keyword_score += weight
                found_keywords.append(keyword)
        
        if found_keywords:
            explanation_parts.append(f"–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: {', '.join(found_keywords[:5])}")
        
        # 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
        pattern_score = 0.0
        found_patterns = []
        for pattern in self.legal_patterns:
            if re.search(pattern, question_lower):
                pattern_score += 0.5
                found_patterns.append(pattern)
        
        if found_patterns:
            explanation_parts.append(f"–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã: {len(found_patterns)}")
        
        # 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö —Ç–µ–º
        topic_score = 0.0
        found_topics = []
        for topic in self.legal_topics:
            if topic in question_lower:
                topic_score += 0.3
                found_topics.append(topic)
        
        if found_topics:
            explanation_parts.append(f"–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ç–µ–º—ã: {', '.join(found_topics)}")
        
        # 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π
        action_score = 0.0
        found_actions = []
        for action in self.legal_actions:
            if action in question_lower:
                action_score += 0.4
                found_actions.append(action)
        
        if found_actions:
            explanation_parts.append(f"–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è: {', '.join(found_actions[:3])}")
        
        # 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö —Å—É–±—ä–µ–∫—Ç–æ–≤
        entity_score = 0.0
        found_entities = []
        for entity in self.legal_entities:
            if entity in question_lower:
                entity_score += 0.2
                found_entities.append(entity)
        
        if found_entities:
            explanation_parts.append(f"–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Å—É–±—ä–µ–∫—Ç—ã: {', '.join(found_entities[:3])}")
        
        # –°—É–º–º–∏—Ä—É–µ–º –≤—Å–µ –±–∞–ª–ª—ã
        total_score = keyword_score + pattern_score + topic_score + action_score + entity_score
        
        # –î–æ–±–∞–≤–ª—è–µ–º –±–æ–Ω—É—Å—ã –∑–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
        bonus_score = 0.0
        
        # –ë–æ–Ω—É—Å –∑–∞ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ë–µ–ª–∞—Ä—É—Å–∏ + —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã
        if any(word in question_lower for word in ['–±–µ–ª–∞—Ä—É—Å—å', '–±–µ–ª–∞—Ä—É—Å–∏', '—Ä–±', '—Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –±–µ–ª–∞—Ä—É—Å—å']):
            if any(word in question_lower for word in ['–∑–∞–∫–æ–Ω', '–ø—Ä–∞–≤–æ', '—Å—É–¥', '–¥–æ–≥–æ–≤–æ—Ä', '–∫–æ–¥–µ–∫—Å']):
                bonus_score += 0.2
        
        # –ë–æ–Ω—É—Å –∑–∞ –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ + —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã
        question_words = ['–∫–∞–∫', '—á—Ç–æ', '–≥–¥–µ', '–∫–æ–≥–¥–∞', '–∫–∞–∫–æ–π', '–∫–∞–∫–∞—è', '–∫–∞–∫–∏–µ', '–∫—Ç–æ', '–ø–æ—á–µ–º—É']
        legal_terms = ['–ø–æ–¥–∞—Ç—å', '–æ—Ñ–æ—Ä–º–∏—Ç—å', '–ø–æ–ª—É—á–∏—Ç—å', '–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å', '–æ–±–∂–∞–ª–æ–≤–∞—Ç—å', '–≤–∑—ã—Å–∫–∞—Ç—å', '–∑–∞—â–∏—Ç–∏—Ç—å']
        
        if any(qw in question_lower for qw in question_words):
            if any(lt in question_lower for lt in legal_terms):
                bonus_score += 0.15
        
        # –ë–æ–Ω—É—Å –∑–∞ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ + –ø—Ä–æ—Ü–µ–¥—É—Ä
        if '–¥–æ–∫—É–º–µ–Ω—Ç' in question_lower:
            if any(word in question_lower for word in ['–Ω—É–∂–Ω—ã', '—Ç—Ä–µ–±—É—é—Ç—Å—è', '–æ—Ñ–æ—Ä–º–∏—Ç—å', '–ø–æ–¥–∞—Ç—å', '–ø–æ–ª—É—á–∏—Ç—å']):
                bonus_score += 0.1
        
        # –ë–æ–Ω—É—Å –∑–∞ –ø—Ä–∞–≤–∞ + –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏
        if any(word in question_lower for word in ['–ø—Ä–∞–≤–∞', '–ø—Ä–∞–≤–æ', '–æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏', '–æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç—å']):
            if any(word in question_lower for word in ['–∏–º–µ—é', '–¥–æ–ª–∂–µ–Ω', '–æ–±—è–∑–∞–Ω', '–º–æ–≥—É', '–º–æ–∂–Ω–æ']):
                bonus_score += 0.1
        
        # –ë–æ–Ω—É—Å –∑–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å + –Ω–∞—Ä—É—à–µ–Ω–∏—è
        if '–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å' in question_lower:
            if any(word in question_lower for word in ['–∫–∞–∫–∞—è', '–∫–∞–∫—É—é', '–Ω–µ—Å–µ—Ç', '–ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞', '–∑–∞']):
                bonus_score += 0.1
        
        total_score += bonus_score
        
        # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Å—á–µ—Ç (–º–∞–∫—Å–∏–º—É–º –ø—Ä–∏–º–µ—Ä–Ω–æ 10-15 –±–∞–ª–ª–æ–≤)
        normalized_score = min(total_score / 8.0, 1.0)  # –£–º–µ–Ω—å—à–∞–µ–º –¥–µ–ª–∏—Ç–µ–ª—å –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        
        is_legal = normalized_score >= self.min_legal_score
        
        explanation = "; ".join(explanation_parts) if explanation_parts else "–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
        
        logger.debug(f"–ê–Ω–∞–ª–∏–∑ –≤–æ–ø—Ä–æ—Å–∞: '{question[:50]}...' - "
                    f"–û—Ü–µ–Ω–∫–∞: {normalized_score:.3f}, "
                    f"–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π: {is_legal}, "
                    f"–û–±—ä—è—Å–Ω–µ–Ω–∏–µ: {explanation}")
        
        return is_legal, normalized_score, explanation
    
    def get_rejection_message(self) -> str:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ –Ω–µ—é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞."""
        return """
üö´ **–ò–∑–≤–∏–Ω–∏—Ç–µ, –Ω–æ —è –æ—Ç–≤–µ—á–∞—é —Ç–æ–ª—å–∫–æ –Ω–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã!**

üáßüáæ **–ú–æ—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
‚öñÔ∏è –ë–µ–ª–æ—Ä—É—Å—Å–∫–æ–µ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ –∏ –ø—Ä–∞–≤–æ
üìã –ì—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–µ, —Ç—Ä—É–¥–æ–≤–æ–µ, —Å–µ–º–µ–π–Ω–æ–µ, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∞–≤–æ –†–ë
üìù –ü—Ä–∞–≤–æ–≤—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç
üèõÔ∏è –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –æ—Ä–≥–∞–Ω–∞–º–∏ –†–ë

**–ü—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —è –º–æ–≥—É –æ—Ç–≤–µ—Ç–∏—Ç—å:**
‚Ä¢ "–ö–∞–∫ –ø–æ–¥–∞—Ç—å –∏—Å–∫ –≤ —Å—É–¥ –≤ –ë–µ–ª–∞—Ä—É—Å–∏?"
‚Ä¢ "–ö–∞–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω—É–∂–Ω—ã –¥–ª—è —Ä–∞–∑–≤–æ–¥–∞ –≤ –†–ë?"
‚Ä¢ "–ö–∞–∫ –æ—Ñ–æ—Ä–º–∏—Ç—å —Ç—Ä—É–¥–æ–≤–æ–π –¥–æ–≥–æ–≤–æ—Ä –ø–æ –¢–ö –†–ë?"
‚Ä¢ "–ö–∞–∫–∏–µ –ø—Ä–∞–≤–∞ —É –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è –≤ –ë–µ–ª–∞—Ä—É—Å–∏?"
‚Ä¢ "–ö–∞–∫ –æ–±–∂–∞–ª–æ–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –æ—Ä–≥–∞–Ω–∞?"
‚Ä¢ "–ö–∞–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞?"

**–ß—Ç–æ —è –ù–ï –º–æ–≥—É:**
‚ùå –ö–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º –≤–æ–ø—Ä–æ—Å–∞–º
‚ùå –î–∞–≤–∞—Ç—å –∫—É–ª–∏–Ω–∞—Ä–Ω—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã
‚ùå –ü–æ–º–æ–≥–∞—Ç—å —Å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏
‚ùå –û—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –ø–æ–≥–æ–¥–µ, —Å–ø–æ—Ä—Ç–µ, —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è—Ö
‚ùå –ö–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º –≤–æ–ø—Ä–æ—Å–∞–º

üí° **–ü–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å –≤ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ**, –µ—Å–ª–∏ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ!

–ù–∞–ø—Ä–∏–º–µ—Ä: "–ö–∞–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞..." –≤–º–µ—Å—Ç–æ "–ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏..."
"""

# –ì–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä —Ñ–∏–ª—å—Ç—Ä–∞
_question_filter = None

def get_question_filter() -> QuestionFilter:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä —Ñ–∏–ª—å—Ç—Ä–∞ –≤–æ–ø—Ä–æ—Å–æ–≤."""
    global _question_filter
    if _question_filter is None:
        _question_filter = QuestionFilter()
    return _question_filter

def is_legal_question(question: str) -> tuple[bool, float, str]:
    """
    –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –≤–æ–ø—Ä–æ—Å —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–º.
    
    Args:
        question: –¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞
        
    Returns:
        –ö–æ—Ä—Ç–µ–∂ (is_legal, score, explanation)
    """
    filter_instance = get_question_filter()
    return filter_instance.is_legal_question(question)

def get_rejection_message() -> str:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ –Ω–µ—é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞."""
    filter_instance = get_question_filter()
    return filter_instance.get_rejection_message() 